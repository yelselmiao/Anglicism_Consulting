---
title: "R Notebook"
output: github_document
editor_options: 
  chunk_output_type: inline
---
I added the columns BE (Where did you grow up?) and BH (Where do you live?). 
I created categories for the cities: Montreal, Sherbrooke, Quebec, Other, ?(where there is no answer).

The social factors I'm interested in: gender (BA), age (BC), where they grew up (BE), where they live (BH), education level (BI), proficiency in English (BP). 

The mean of the scores for Part 1 are on the last row. 



Part 1
Q1 to Q15:



In all these sentences, the use of angliscism is "innovative". The anglicisms are used in a way that is acceptable for young people, but not so much for older people. This use of anglicisms differs from the standard.  
They are asked to evaluate the sentence according to the 5 points above. 
I'd like to know how the scores relate to the social factors: gender (BA), age (BC), where they grew up (BE), where they live (BH), education level (BI), proficiency in English (BP).  

RQ1: Which of these factors (if any) are correlated to the scores in Part 1?

Part 2
The participants have to choose one of the possible three sentences: an innovative use of anglicism (in bold), a more traditional one, or give another sentence that they would use.
(I put in bold the innovative forms.)
RQ1: How many people used each of these sentence?
RQ2: Does the use of the innovative forms correlates with any of the social factors? (same ones as above)

Q20: (a) J’ai domp ma blonde. (b) J’ai dompé ma blonde. (c) Neither! I would rather say this:  
Q21: (a) T’as juste à scroll en bas. (b) T’as juste à scroller en bas. (c) Neither! I would rather say:  
Q22: (a) As-tu enjoyé ton voyage? (b) As-tu enjoy ton voyage? (c) Neither! I would rather say:  
Q23: (a) Je l'ai texté hier. (b) Je l'ai text hier. (c) Neither! I would rather say:  
Q24: (a) Il m'a ghost. (b) Il m'a ghosté. (c) Neither! I would rather say:  
Q25: (a) Tu m'as skipé. (b) Tu m'as skip. (c) Neither! I would rather say:  
Q26: (a) J'ai bu du vin et j'ai pass out dans mon lit. (b) J'ai bu du vin et j'ai passé out dans mon lit. (c) Neither! I would rather say:  
Q27: (a) Est-ce que Paul va être kické out du cours? (b) Est-ce que Paul va être kick out du cours? (c) Neither! I would rather say:  
Q28: (a) On doit upgrade notre forfait d'internet. (b) On doit upgrader notre forfait d'internet. (c) Neither! I would rather say:  
Q29: (a) Tu m'as spottée dans mon auto. (b) Tu m'as spot dans mon auto. (c) Neither! I would rather say:  

No need to look at Parts 3-5. 

```{r Library}
suppressPackageStartupMessages(library(tidyverse))
library(scales)
```


```{r Load Data}
raw_data <- readxl::read_xlsx(paste0(here::here(), '/Data/survey_data.xlsx'), sheet = "Results")
raw_data <- raw_data[2:(nrow(raw_data)-1),]
  
data <- raw_data %>%
  dplyr::select(c(2:36, 53, 55, 57, 60, 61, 68)) %>%
  rename(p1_1 = Q4_1, # part 1: 15 sentences
         p1_2 = Q5_1,
         p1_3 = Q6_1,
         p1_4 = Q7_1,
         p1_5 = Q8_1,
         p1_6 = Q9_1,
         p1_7 = Q10_1,
         p1_8 = Q11_1,
         p1_9 = Q12_1,
         p1_10 = Q13_1,
         p1_11 = Q14_1,
         p1_12 = Q15_1,
         p1_13 = Q16_1,
         p1_14 = Q17_1,
         p1_15 = Q18_1, # part 2: 10 questions
         p2_1_choice = Q20,
         p2_1_other = Q20_3_TEXT,
         p2_2_choice = Q21,
         p2_2_other = Q21_3_TEXT,
         p2_3_choice = Q22,
         p2_3_other = Q22_3_TEXT,
         p2_4_choice = Q23,
         p2_4_other = Q23_3_TEXT,
         p2_5_choice = Q24,
         p2_5_other = Q24_3_TEXT,
         p2_6_choice = Q25,
         p2_6_other = Q25_3_TEXT,
         p2_7_choice = Q26,
         p2_7_other = Q26_3_TEXT,
         p2_8_choice = Q27,
         p2_8_other = Q27_3_TEXT,
         p2_9_choice = Q28,
         p2_9_other = Q28_3_TEXT,
         p2_10_choice = Q29,
         p2_10_other = Q29_3_TEXT,
         gender = Q45, 
         age = Q46, 
         grew_up = `...57`, 
         live = `...60`, 
         edu_level = Q50, 
         eng_pro = Q51
         ) %>% 
  dplyr::select(-c(seq(17, 35, 2))) %>%
  mutate_at(c(1:15, 27), as.numeric) %>% 
  mutate_if(is.character, as.factor)







```

# Overview of Participants 
```{r gender}
data <- data %>%
  mutate(gender = recode(gender,
                      `Femme` = "Woman",
                      `Homme` = "Man",
                      `Prefer not to answer` = 'I prefer not to answer',
                      `Prefer to define myself:` = 'Other')) 
data %>%
  group_by(gender) %>% 
  tally() %>% 
  mutate(prop = percent(n/sum(n)))
```

```{r Age, Warning = FALSE, warning = FALSE}
#8 people did not reveal their age
nrow(data %>% 
  filter(is.na(age)))

# range of age
range(data$age, na.rm = TRUE)

# take a glance
data %>% 
  ggplot(aes(x = age)) + 
  geom_histogram()

# age group 
data %>% 
  dplyr::select(age) %>% 
  drop_na() %>%
  mutate(age_group = case_when(age < 20 ~ '< 20',
                               age >= 20 & age < 30 ~ '20 - 30',
                               age >= 30 & age < 40 ~ '30 - 40',
                               age >= 40 & age < 50 ~ '40 - 50',
                               age >= 50 ~ '> 50')) %>% 
  group_by(age_group) %>% 
  tally() %>% 
  mutate(prop = percent(n/sum(n)))
```

```{r Living places}
# excluding NA and one person live in Winsor
raw_data %>% 
  filter(is.na(`...60`) | `...60` == '?')

data %>% 
  filter(!is.na(live) & live != '?') %>% 
  group_by(live) %>% 
  tally() %>% 
  mutate(prop = percent(n/sum(n)))
```

```{r education level}
data %>% 
  group_by(edu_level) %>% 
  tally() %>% 
  mutate(prop = percent(n/sum(n)))
```
```{r Place growing up}
# fix typo in place growing up 
data <- data %>%
  mutate(grew_up = replace(grew_up, grew_up == 'S', 'Sherbrooke'))

# check missing value 
nrow(data %>% 
  filter(is.na(grew_up) | grew_up == '?'))

data %>% 
  filter(!is.na(grew_up) & grew_up != '?') %>% 
  group_by(grew_up) %>% 
  tally() %>% 
  mutate(prop = percent(n/sum(n)))
```


```{r Profiency in English (on hold)}
unique(data$eng_pro)
```

# Analysis of Part 1 

I'd like to know how the scores relate to the social factors: gender (BA), age (BC), where they grew up (BE), where they live (BH), education level (BI), proficiency in English (BP).  

```{r data prep}
# p1_data <- data %>% 
#   select(-c(16:25)) %>% 
#   mutate(id = 1:nrow(data)) %>%
#   pivot_longer(cols = -c(gender,age, grew_up, live, edu_level, eng_pro, id), names_to = 'sentence', values_to = 'score') 

p1_data_wide <- data %>%
  select(-c(16:25)) %>%
  mutate(id = 1:nrow(data), 
         score_sum = rowSums(.[1:15]),
         score_mean = rowMeans(.[1:15])) %>% 
  select(-c(1:15)) 

p1_data_long <- data %>%
  select(-c(16:25)) %>%
  mutate(id = 1:nrow(data)) %>%
  pivot_longer(cols = -c(gender,age, grew_up, live, edu_level, eng_pro, id), names_to = 'sentence', values_to = 'score')

```


```{r score vs.gender}
# boxplot test 
p1_data_long %>% 
  filter(gender %in% c('Woman', 'Man')) %>% 
  group_by(gender) %>%
  ggplot(aes(x = gender, y = score, color = gender)) + 
  geom_violin() + 
  labs(x = 'Gender', y = 'Mean score', fill = 'Gender') + 
  theme(axis.title.x = element_text(size = 15,face = 'bold'),
        axis.title.y = element_text(size = 15,face = 'bold'),
        axis.text.y = element_text(size = 15),
        axis.text.x = element_text(size = 15))

  
          
woman_score <- p1_data_wide %>% filter(gender == 'Woman') %>% dplyr::select(score_mean)
man_score <- p1_data_wide %>% filter(gender == 'Man') %>% dplyr::select(score_mean)

# two-sample tests
t.test(woman_score, man_score)
wilcox.test(woman_score$score_mean, man_score$score_mean)

# corr analysis for each sentence
p1_data_long_gender_encoded <-  p1_data_long %>% 
  filter(gender %in% c('Woman', 'Man')) %>% 
  mutate(gender_encode = ifelse(gender == 'Woman', 1, 0)) 

p1_data_long_gender_encoded %>% 
  mutate(sentence = as.factor(sentence)) %>% 
  group_by(sentence) %>% 
  summarize(corr_coef = cor(score, gender_encode, method="kendall", use = "complete.obs"),
            p_value = cor.test(score,gender_encode)[["p.value"]])

```


```{r score vs. age}
# for each sentence
p1_data_long %>% 
  mutate(sentence = as.factor(sentence)) %>% 
  group_by(sentence) %>% 
  summarize(corr_coef = cor(age, score, method="kendall", use = "complete.obs"),
            p_value = cor.test(age, score)[["p.value"]])
# overall
cor.test(p1_data_wide$score_mean, p1_data_wide$age)
```

```{r}

```











